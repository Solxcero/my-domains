## 데이터 파이프라인 구축
1. 배치 처리 파이프라인    
정해진 시간이나 트리거에 따라 데이터를 일괄 처리하는 방식.   
대량의 데이터를 효율적으로 처리할 수 있으며, 주기적인 보고서 생성이나 대규모 데이터 분석 등에 적합.  
예_ 매일 또는 매주 사용자 행동 데이터를 분석하여 인사이트를 도출하는 경우에 배치 처리 파이프라인 사용. 

2. 스트리밍 처리 파이프라인     
실시간으로 데이터를 수집, 처리하는 방식으로, 데이터가 생성되는 즉시 파이프라인을 통해 흐르게 됨.   
실시간 모니터링, 알람 시스템, 실시간 사용자 인터랙션 분석 등에 필요.  
예_신용카드 사기 거래 탐지 시스템에서는 스트리밍 처리 파이프라인을 통해 거래가 발생하는 즉시 분석 수행. 의심스러운 거래 즉각적으로 감지    

데이터 수집 단계에서는 Kafka와 같은 메시지 큐 시스템을 통해 다양한 소스로부터 실시간 데이터 수집하고, Redis와 같은 인메모리 데이터 스토어를 사용하여 필요한 정보에 즉각적으로 접근.   

데이터 파이프라인을 자동화하고 조율하는 도구로는 Apache Airflow가 광범위하게 사용됨. 

## 모델 패키징
`ONNX` 는 다양한 프로그램으로 만든 모델을 표준화된 형태로 바꿔서 어디서든 쓸 수 있게 해줌.   
`PMML` 은 데이터 분석 모델을 표준화된 XML 파일로 저장해, 다양한 도구에서 쉽게 사용할 수 있게 해줌.  
`텐서플로 SavedModel` 텐서플로 모델 전용 포멧   
`파이토치 TorchScript`   
`Docker` 애플리케이션이 어떤 컴퓨터에서든 동일하게 실행될 수 있도록 모든 필요한 파일과 설정을 포함하는 컨테이너 만듦.

## 배포
1. 웹서비스   
REST API 형태로 배포하면 어떤 애플리케이션이든 모델에 HTTP 요청을 통해 예측을 요청할 수 있음.  
2. 클라우드 서비스  
아마존 세이지메이커, 구글 클라우드 AI 플랫폼, 애저 머신러닝 등. 
3. 온프레미스 서버  
4. 에지 디바이스 
5. 머신러닝 모델 서버 

## 프로덕션 환경에서 모델 테스트 방법
1. 블루/그린 배포 : '블루' 환경에서 현재 서비스 되고 있는 모델과 '그린'환경에 새로운 모델을 배치. 테스트가 완료되고 새 모델이 안정적이라고 판단되면 트래픽을 새 모델이 있는 그린 환경으로 전환. 롤백이 쉬움. 
2. 섀도 배포 : 실제 사용자 트래픽은 이전 모델에만 서비스되지만, 동시에 새 모델도 동일한 트래픽이 복사되어 전송. 새 모델에서의 처리 결과는 사용자에게 보이지 않으며, 모델의 성능 평가 목적으로만 사용. 실제 환경에서 새 모델을 테스트할 수 있다는 장점. 실제 효과 확인은 어렵.  
3. A/B 테스트 : 사용자 그룹을 무작위로 나누어 한 그룹에는 기존 모델을, 다른 그룹에는 새 모델 적용. 성능 더 잘 나오는 걸로 선택. 테스트 기간 동안 사용자 경험에 영향을 준다는 문제.
4. 카나리 배포 : 새 모델을 소수의 사용자에게만 먼저 배포하여 테스트하고, 문제가 없을 경우 점진적으로 더 많은 사용자에게 배포. 
5. 인터리빙 배포 : 두 모델의 결과 를 번갈아 가며 사용자에게 제공하여, 사용자 반응을 기반으로 더 나은 모델 선택. 
6. 두 단계 실험 과정 : 초기에는 소규모 사용자 그룹을 대상으로 실험을 진행하고, 성공적이라면 점진적으로 실험을 확대하는 방법. 카나리 배포와 유사하지만 실험 과정을 더 세분화하여 진행. 
7. 멀티 암드 밴딧 알고리즘 배포 : 여러 모델 중에서 자동으로 최적의 모델을 선택하도록 함. 사용자 반응을 실시간으로 분석하여 가장 성능이 좋은 모델에 점차 더 많은 트래픽 할당. 

## 성능 모니터링 
1. 공변량 시프트 
: 우리가 모델을 학습시킬 때 사용한 입력 데이터의 분포가 시간이 지나면서 변하는 현상. 하지만 주어진 입력 데이터에 대한 출력(예측값)의 조건부 확률은 변하지 않음. 즉 입력 데이터는 바뀌었지만, 이 데이터를 바탕으로 예측하는 과정은 그대로라는 뜻.   

2. 개념 드리프트 
: 입력 데이터의 분포는 변하지 않지만, 그 입력 데이터에 대한 출력(예측값)의 조건부 확률이 변하는 현상. 이는 주로 사회적, 계절적, 경제적 변화 또는 행동 패턴의 변화로 인해 발생. 

3. 모델 성능 저하를 불러오는 변화 유형
- 피처 변화 
- 레이블 스키마 변화 : Y값 범위가 변함.

4. 데이터 분포 시프트 변화 감지하는 방법
- PSI : 두 데이터 집합 간의 데이터 분포 차이
- KLD : 두 확률 분포 간의 상대적 차이를 측정하는 방법. 비대칭이기 때문에 값 해석 어려울 수 있음
- Jensen-Shannon distance : 두 확률 분포 간의 차이 측정. 0과 1사이 값. 값이 클수록 두 분포 간 차이 큼. KLD의 비대칭성 해결-> 결과값 해석 용이. 계산 과정 복잡
- Wasserstein distance : 두 확률 분포 간의 거리 측정. 한 분포에서 다른 분포로 변환하는 데 필요한 최소 작업량 의미. 값이 클수록 두 폰 간의 차이가 큼.
- K-S test : 두 데이터 집합이 같은 분포에서 추출되었는지를 검증하는 방법. 두 분포 간의 최대 차이 측정하고 이 차이가 특정 임곗값을 초과하면 데이터 드리프트 발생 판단. 비모수적 검정으로 데이터 분포에 대한 가정이 필요없다는 장점이 있지만 통계적 검정력이 다소 약할 수 있음
