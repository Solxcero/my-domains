## 피처 엔지니어링
`IV` 와 `WoE`는 변수 선택과 변환에 있어 핵심적인 지표롤 활용됨. 또한 이산화 또는 구간화는 연속 변수를 의미 있는 구간으로 나누어 모델의 예측력을 향상시키는 방법. 

### `WoE : Weight of Evidence`  
는 주로 범주형 변수의 효과를 측정하는 데 사용. 변수의 각 범주가 타깃 변수에 미치는 영향의 강도와 방향을 나타냄.
    1. 연속형 변수의 경우, 데이터를 여러 구간(보통 10개 정도)의 버킷(bin)으로 분할
    2. 각 버킷에서 타깃 사건(예: 연체)과 비타깃 사건의 수를 집계
    3. 각 버킷에서 타깃 사건의 비율과 비타깃 사건의 비율을 계산
    4. 각 버킷의 타깃 사건 비율을 비타깃 사건 비율로 나누고, 자연로그를 취해 WoE 계산

### `IV : Informatino Value` 
는 이러한 WoE 값들을 사용해 전체 변수의 예측력을 수치화하는 지표로, 변수가 모델을 통헤 예측하는 데 얼마나 중요한지를 평가. 
    - 0.02 이하 : 예측에 유용하지 않음
    - 0.02 ~ 0.1 : 약한 예측력
    - 0.1 ~ 0.3 : 보통의 예측력
    - 0.3 ~ 0.5 : 강한 예측력
    - 0.5 이상 (너무 강력해서) 의심스러운 예측력

- 예제 : `나이` 면수로 WoE와 IV 계산 -> 나이를 10년 단위로 구분 

```python 
# 연령대 20~29의 연체 고객 수와 비연체 구객 수
age_20_29_default = 10
age_20_29_non_default = 90

# 전체 대출 고객 중 연체 고객 수와 비연체 고객 수
tatal_default = 100
total_non_default = 900

# 연령대 20~29의 연체 비율과 비연체 비율 계산
default_rate_20_29 = age_20_29_default / total_default
non_default_rate_20_29 = age_20_29_non_default / total_non_default

# WoE 계산
woe_20_29 = np.log(default_rate_20_29 / non_default_rate_20_29)
woe_20_29_value = woe_20_29.item() if woe_20_29.size > 0 else "Undefined"
```

위의 과정을 전 나이대에서 수행. 

IV = (각 연령대의 연체 사건 비율 - 비연체 사건 비율) * WoE

### fine classing 
변수 구간 나누는 기법1
- 변수를 매우 세밀한 구간으로 나눔. (나이를 5년 단위로 나누기 등) -> 더 정밀한 예측 가능 but 과적합 위험있으므로 충분한 데이터 확보된 경우에 주로 사용

### coarse classing
변수 구간 나누는 기법2
- 보다 큰 구간으로 변수 나눔 (나이를 10년 단위로 나누기 등) -> 데이터 부족하거나 과적합 방지하고자 할 때
-----------------------------

신용 평가에서 주요 과제는 충분한 정보를 유지하면서도 모델의 복잡성을 적절히 관리하는 것. 

### 변수 선택
1. 필터 방법 
- 데이터의 특성과 목표 변수와의 관련성을 수치화하여 변수를 선택하는 기법. 
- 피어슨 상관계수, 카이제곱 검정, ANOVA, 피셔 점수, IV 등을 포함한 다양한 통계적 방법 사용
- 계산이 빠르고 간단. 하지만 변수 간의 상호작용은 고려하지 않음 
2. 래퍼 방법 
- 모델의 예측 성능을 기준으로 변수의 중요도를 평가
- RFE(recursive feature elimination), 후진 소거법, 전진 선택법 등
- 변수 선택 과정이 모델 훈련과 밀접하게 연결되어 있어, 변수 간의 상호작용도 고려할 수 있음. 하지만 계산 비용이 높음.
- 예측 정확도 최적화하는 동시에 필요한 변수 수를 최소화하려는 목적으로 사용
3. 임베디드/모델 기반 방법 
- 모델 자체에서 제공하는 변수의 중요도를 기반으로 변수 선택
- 피쳐중요도, 정규화 기법
- 모델 성능과 변수 간 상호작용 모두 고려하며 계산 비용 적절. 


## 스코어링
신용 평가 모델에서 확률을 사용하여 신용 점수를 계산하는 방법은 모델이 제공하는 확률값을 기반으로 고객의 신용 위험을 수치화함.   
이 과정에서 `Base Score (모든 고객에게 기본적으로 할당되는 점수)`와 `PDO (point to double the odds, 확률의 변화가 신용점수에 얼마나 영향을 미치는지)`가 중요한 역할을 함.  

**점수 계산 순서**
1. 모델 확률값의 취득 : 신용 평가 모델(ex.XGBoost)을 통해 고객의 연체 가능성에 대한 확률값을 산출. 이 확률값은 고객이 특정 시간 내에 연체할 가능성을 나타냄
2. Odds 계산 : 확률값(P)을 사용하여 Odds 계산. Odds는 연체 가능성에 대한 확률값에 대한 비율로, `P/(1-P)` 공식으로 계산. 이는 고객이 연체할 가능성 대비 연체하지 않을 가능성의 비율
3. PDO와 Base Score 적용
    - Factor 계산 : `Factor = PDO/ln(2)`. 확률의 변화가 신용 점수에 미치는 영향력 조정
    - Offset 계산 : `Offset = Base Score - (Factor * ln(Target Odds))` . Target Odds는 모델 개발 시 선정한 기준 Odds
4. 최종 신용 점수 계산 : `score = Offset + (Factor * ln(Odds))`. 계산한 신용 점수는 일반적으로 특정 범위 내에서 조정할 수 있으며, 이는 금융기관의 요구 사항에 따라 달라질 수 있음.




